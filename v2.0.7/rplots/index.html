<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Recurrence Plots · RecurrenceAnalysis.jl</title><meta name="title" content="Recurrence Plots · RecurrenceAnalysis.jl"/><meta property="og:title" content="Recurrence Plots · RecurrenceAnalysis.jl"/><meta property="twitter:title" content="Recurrence Plots · RecurrenceAnalysis.jl"/><meta name="description" content="Documentation for RecurrenceAnalysis.jl."/><meta property="og:description" content="Documentation for RecurrenceAnalysis.jl."/><meta property="twitter:description" content="Documentation for RecurrenceAnalysis.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RecurrenceAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">RecurrenceAnalysis.jl</a></li><li class="is-active"><a class="tocitem" href>Recurrence Plots</a><ul class="internal"><li><a class="tocitem" href="#Recurrence-Matrices"><span>Recurrence Matrices</span></a></li><li><a class="tocitem" href="#Advanced-recurrences-specification"><span>Advanced recurrences specification</span></a></li><li><a class="tocitem" href="#Simple-Recurrence-Plots"><span>Simple Recurrence Plots</span></a></li><li><a class="tocitem" href="#Advanced-Recurrence-Plots"><span>Advanced Recurrence Plots</span></a></li><li><a class="tocitem" href="#Skeletonized-Recurrence-Plots"><span>Skeletonized Recurrence Plots</span></a></li><li><a class="tocitem" href="#Distance-matrix"><span>Distance matrix</span></a></li><li><a class="tocitem" href="#StateSpaceSet-reference"><span><code>StateSpaceSet</code> reference</span></a></li></ul></li><li><a class="tocitem" href="../quantification/">Recurrence Quantification Analysis</a></li><li><a class="tocitem" href="../networks/">Recurrence Networks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Recurrence Plots</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Recurrence Plots</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/main/docs/src/rplots.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Recurrence-Plots"><a class="docs-heading-anchor" href="#Recurrence-Plots">Recurrence Plots</a><a id="Recurrence-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Recurrence-Plots" title="Permalink"></a></h1><h2 id="Recurrence-Matrices"><a class="docs-heading-anchor" href="#Recurrence-Matrices">Recurrence Matrices</a><a id="Recurrence-Matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Recurrence-Matrices" title="Permalink"></a></h2><p>A <a href="https://en.wikipedia.org/wiki/Recurrence_plot">Recurrence plot</a> (which refers to the plot of a recurrence matrix) is a way to quantify <em>recurrences</em> that occur in a trajectory. A recurrence happens when a trajectory visits the same neighborhood on the phase space that it was at some previous time.</p><p>The central structure used in these recurrences is the (cross-) recurrence matrix:</p><p class="math-container">\[R[i, j] = \begin{cases}
1 \quad \text{if}\quad d(x[i], y[j]) \le \varepsilon\\
0 \quad \text{else}
\end{cases}\]</p><p>where <span>$d(x[i], y[j])$</span> stands for the <em>distance</em> between trajectory <span>$x$</span> at point <span>$i$</span> and trajectory <span>$y$</span> at point <span>$j$</span>. Both <span>$x, y$</span> can be single timeseries, full trajectories or embedded timeseries (which are also trajectories).</p><p>If <span>$x\equiv y$</span> then <span>$R$</span> is called recurrence matrix, otherwise it is called cross-recurrence matrix. There is also the joint-recurrence variant, see below. With <code>RecurrenceAnalysis</code> you can use the following functions to access these matrices</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.RecurrenceMatrix" href="#RecurrenceAnalysis.RecurrenceMatrix"><code>RecurrenceAnalysis.RecurrenceMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RecurrenceMatrix(x, rthres; metric = Euclidean(), parallel::Bool)</code></pre><p>Create a recurrence matrix from timeseries or trajectory <code>x</code> and with recurrence threshold <code>rthres</code>. <code>x</code> is either a <a href="#StateSpaceSets.StateSpaceSet"><code>StateSpaceSet</code></a> for multivariate data or an <code>AbstractVector{&lt;:Real}</code> for timeseries.</p><p>The variable <code>rthres</code> defines how recurrences are estimated. It can be any subtype of <a href="#RecurrenceAnalysis.AbstractRecurrenceType"><code>AbstractRecurrenceType</code></a>, and different types can specify recurrences differently. Alternatively, <code>rthres</code> can be a real number, which then becomes an instance of <a href="#RecurrenceAnalysis.RecurrenceThreshold"><code>RecurrenceThreshold</code></a>.</p><p>The keyword <code>metric</code>, if given, must be any subtype of <code>Metric</code> from <a href="https://github.com/JuliaStats/Distances.jl">Distances.jl</a> and defines the metric used to calculate distances for recurrences. By default the Euclidean metric is used, typical alternatives are <code>Chebyshev(), Cityblock()</code>.</p><p>The keyword <code>parallel</code> decides if the comptutation should be done in parallel using threads. Defaults to <code>length(x) &gt; 500 &amp;&amp; Threads.nthreads() &gt; 1</code>.</p><p><strong>Description</strong></p><p>A (cross-)recurrence matrix is a way to quantify <em>recurrences</em> that occur in a trajectory. A recurrence happens when a trajectory visits the same neighborhood on the state space that it was at some previous time.</p><p>The recurrence matrix is a numeric representation of a recurrence plot, described in detail in <sup class="footnote-reference"><a id="citeref-Marwan2007" href="#footnote-Marwan2007">[Marwan2007]</a></sup> and <sup class="footnote-reference"><a id="citeref-Marwan2015" href="#footnote-Marwan2015">[Marwan2015]</a></sup>. It represents a a sparse square matrix of Boolean values that quantifies recurrences in the trajectory, i.e., points where the trajectory returns close to itself. Given trajectories <code>x, y</code>, and asumming <code>ε isa Real</code>, the matrix is defined as:</p><pre><code class="language-julia hljs">R[i,j] = metric(x[i], y[i]) ≤ ε ? true : false</code></pre><p>with the <code>metric</code> being the distance function. The difference between a <code>RecurrenceMatrix</code> and a <a href="#RecurrenceAnalysis.CrossRecurrenceMatrix"><code>CrossRecurrenceMatrix</code></a> is that in the first case <code>x === y</code>.</p><p>Objects of type <code>&lt;:AbstractRecurrenceMatrix</code> are displayed as a <a href="#RecurrenceAnalysis.recurrenceplot"><code>recurrenceplot</code></a>.</p><p>See also: <a href="#RecurrenceAnalysis.CrossRecurrenceMatrix"><code>CrossRecurrenceMatrix</code></a>, <a href="#RecurrenceAnalysis.JointRecurrenceMatrix"><code>JointRecurrenceMatrix</code></a> and use <a href="#RecurrenceAnalysis.recurrenceplot"><code>recurrenceplot</code></a> to turn the result of these functions into a plottable format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_matrix_types.jl#L88-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.CrossRecurrenceMatrix" href="#RecurrenceAnalysis.CrossRecurrenceMatrix"><code>RecurrenceAnalysis.CrossRecurrenceMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CrossRecurrenceMatrix(x, y, rthres; kwargs...)</code></pre><p>Create a cross recurrence matrix from trajectories <code>x</code> and <code>y</code>. See <a href="#RecurrenceAnalysis.RecurrenceMatrix"><code>RecurrenceMatrix</code></a> for possible value for <code>rthres</code> and <code>kwargs</code>.</p><p>The cross recurrence matrix is a bivariate extension of the recurrence matrix. For the time series <code>x</code>, <code>y</code>, of length <code>n</code> and <code>m</code>, respectively, it is a sparse <code>n×m</code> matrix of Boolean values.</p><p>Note that cross recurrence matrices are generally not symmetric irrespectively of <code>rthres</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_matrix_types.jl#L171-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.JointRecurrenceMatrix" href="#RecurrenceAnalysis.JointRecurrenceMatrix"><code>RecurrenceAnalysis.JointRecurrenceMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">JointRecurrenceMatrix(x, y, rthres; kwargs...)</code></pre><p>Create a joint recurrence matrix from trajectories <code>x</code> and <code>y</code>. See <a href="#RecurrenceAnalysis.RecurrenceMatrix"><code>RecurrenceMatrix</code></a> for possible values for <code>rthres</code> and <code>kwargs</code>.</p><p>The joint recurrence matrix considers the recurrences of the trajectories of <code>x</code> and <code>y</code> separately, and looks for points where both recur simultaneously. It is calculated by the element-wise multiplication of the recurrence matrices of <code>x</code> and <code>y</code>. If <code>x</code> and <code>y</code> are of different length, the recurrences are only calculated until the length of the shortest one.</p><p>See <a href="#RecurrenceAnalysis.RecurrenceMatrix"><code>RecurrenceMatrix</code></a> for details, references and keywords.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_matrix_types.jl#L208-L221">source</a></section><section><div><pre><code class="language-julia hljs">JointRecurrenceMatrix(R1::AbstractRecurrenceMatrix, R2::AbstractRecurrenceMatrix)</code></pre><p>Equivalent with <code>R1 .* R2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_matrix_types.jl#L235-L239">source</a></section></article><h2 id="Advanced-recurrences-specification"><a class="docs-heading-anchor" href="#Advanced-recurrences-specification">Advanced recurrences specification</a><a id="Advanced-recurrences-specification-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-recurrences-specification" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.AbstractRecurrenceType" href="#RecurrenceAnalysis.AbstractRecurrenceType"><code>RecurrenceAnalysis.AbstractRecurrenceType</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractRecurrenceType</code></pre><p>Supertype of all recurrence specification types. Instances of subtypes are given to <a href="#RecurrenceAnalysis.RecurrenceMatrix"><code>RecurrenceMatrix</code></a> and similar constructors to specify recurrences. Use <a href="#RecurrenceAnalysis.recurrence_threshold"><code>recurrence_threshold</code></a> to extract the numeric distance threshold.</p><p>Possible subtypes are:</p><ul><li><code>RecurrenceThreshold(ε::Real)</code>: Recurrences are defined as any point with distance <code>≤ ε</code> from the referrence point.</li><li><code>RecurrenceThresholdScaled(ratio::Real, scale::Function)</code>: Here <code>scale</code> is a function of the distance matrix <code>dm</code> (see <a href="#RecurrenceAnalysis.distancematrix"><code>distancematrix</code></a>) that is used to scale the value of the recurrence threshold <code>ε</code> so that <code>ε = ratio*scale(dm)</code>. After the new <code>ε</code> is obtained, the method works just like the <code>RecurrenceThreshold</code>. Specialized versions are employed if <code>scale</code> is <code>mean</code> or <code>maximum</code>.</li><li><code>GlobalRecurrenceRate(q::Real)</code>: Here the number of total recurrence rate over the whole matrix is specified to be a quantile <code>q ∈ (0,1)</code> of the <a href="#RecurrenceAnalysis.distancematrix"><code>distancematrix</code></a>. In practice this yields (approximately) a ratio <code>q</code> of recurrences out of the total <code>Nx * Ny</code> for input trajectories <code>x, y</code>.</li><li><code>LocalRecurrenceRate(r::Real)</code>: The recurrence threhsold here is point-dependent. It is defined so that each point of <code>x</code> has a fixed number of <code>k = r*N</code> neighbors, with ratio <code>r</code> out of the total possible <code>N</code>. Equivalently, this means that each column of the recurrence matrix will have exactly <code>k</code> true entries. Notice that <code>LocalRecurrenceRate</code> does not guarantee that the resulting recurrence matrix will be symmetric.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_specification.jl#L4-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.RecurrenceThreshold" href="#RecurrenceAnalysis.RecurrenceThreshold"><code>RecurrenceAnalysis.RecurrenceThreshold</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RecurrenceThreshold(ε::Real)</code></pre><p>Recurrences are defined as any point with distance <code>≤ ε</code> from the referrence point. See <a href="#RecurrenceAnalysis.AbstractRecurrenceType"><code>AbstractRecurrenceType</code></a> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_specification.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.RecurrenceThresholdScaled" href="#RecurrenceAnalysis.RecurrenceThresholdScaled"><code>RecurrenceAnalysis.RecurrenceThresholdScaled</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RecurrenceThresholdScaled(ratio::Real, scale::Function)</code></pre><p>Recurrences are defined as any point with distance <code>≤ d</code> from the referrence point, where <code>d</code> is a scaled ratio (specified by <code>ratio, scale</code>) of the distance matrix. See <a href="#RecurrenceAnalysis.AbstractRecurrenceType"><code>AbstractRecurrenceType</code></a> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_specification.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.GlobalRecurrenceRate" href="#RecurrenceAnalysis.GlobalRecurrenceRate"><code>RecurrenceAnalysis.GlobalRecurrenceRate</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GlobalRecurrenceRate(rate::Real)</code></pre><p>Recurrences are defined as a constant global recurrence rate. See <a href="#RecurrenceAnalysis.AbstractRecurrenceType"><code>AbstractRecurrenceType</code></a> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_specification.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.LocalRecurrenceRate" href="#RecurrenceAnalysis.LocalRecurrenceRate"><code>RecurrenceAnalysis.LocalRecurrenceRate</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LocalRecurrenceRate(rate::Real)</code></pre><p>Recurrences are defined as a constant local recurrence rate. See <a href="#RecurrenceAnalysis.AbstractRecurrenceType"><code>AbstractRecurrenceType</code></a> for more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_specification.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.recurrence_threshold" href="#RecurrenceAnalysis.recurrence_threshold"><code>RecurrenceAnalysis.recurrence_threshold</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">recurrence_threshold(rt::AbstractRecurrenceType, x [, y] [, metric]) → ε</code></pre><p>Return the calculated distance threshold <code>ε</code> for <code>rt</code>. The output is real, unless <code>rt isa LocalRecurrenceRate</code>, where <code>ε isa Vector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/recurrence_specification.jl#L78-L82">source</a></section></article><h2 id="Simple-Recurrence-Plots"><a class="docs-heading-anchor" href="#Simple-Recurrence-Plots">Simple Recurrence Plots</a><a id="Simple-Recurrence-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-Recurrence-Plots" title="Permalink"></a></h2><p>The recurrence matrices are internally stored as sparse matrices with Boolean values. Typically in the literature one does not sees the plots of the matrices  (hence &quot;Recurrence Plots&quot;). By default, when a Recurrence Matrix is created we &quot;show&quot; a mini plot of it which is a text-based scatterplot.</p><p>Here is an example recurrence plot/matrix of a full trajectory of the Roessler system:</p><pre><code class="language-julia hljs">using RecurrenceAnalysis, DynamicalSystemsBase

# Create trajectory of Roessler system
@inbounds function roessler_rule(u, p, t)
    a, b, c = p
    du1 = -u[2]-u[3]
    du2 = u[1] + a*u[2]
    du3 = b + u[3]*(u[1] - c)
    return SVector(du1, du2, du3)
end
p0 = [0.15, 0.2, 10.0]
u0 = ones(3)
ro = CoupledODEs(roessler_rule, u0, p0)
N = 2000; Δt = 0.05
X, t = trajectory(ro, N*Δt; Δt, Ttr = 10.0)

# Make a recurrence matrix with fixed threshold
R = RecurrenceMatrix(X, 5.0)
recurrenceplot(R; ascii = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">    <span class="sgr97"><span class="sgr1">(2001, 2001) RecurrenceMatrix with 383575 recurrences of type RecurrenceThreshold.</span></span> 
    <span class="sgr90">+------------------------------------------------------------+</span> 
    <span class="sgr90">|</span>         <span class="sgr36">..:&#39;.::&#39;</span>       <span class="sgr36">.::&#39;.:&#39;..:&#39;</span>       <span class="sgr36">..:&#39;.::</span>    <span class="sgr36">..</span>  <span class="sgr36">.:&#39;</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>   <span class="sgr36">..</span>  <span class="sgr36">.::&#39;.:&#39;&#39;</span>   <span class="sgr36">.:&#39;</span> <span class="sgr36">.:&#39;..&#39;&#39;.::&#39;</span>   <span class="sgr36">.</span>   <span class="sgr36">.::&#39;.:&#39;</span>    <span class="sgr36">.:&#39;..:&#39;</span>  <span class="sgr90">|</span> 
    <span class="sgr90">|</span> <span class="sgr36">.:&#39;:.:&#39;.::&#39;</span> <span class="sgr36">.</span>  <span class="sgr36">.:&#39;.::&#39;.::&#39;.:&#39;</span>    <span class="sgr36">.:&#39;.::&#39;.::&#39;..</span>  <span class="sgr36">::&#39;.::&#39;.:&#39;</span> <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">:&#39;.::&#39;.::&#39;</span>      <span class="sgr36">:.:::.:&#39;</span>    <span class="sgr36">..</span>    <span class="sgr36">&#39;.::&#39;.::&#39;</span>      <span class="sgr36">:.:::.:&#39;</span>   <span class="sgr90">|</span> 
    <span class="sgr90">|</span> <span class="sgr36">&#39;&#39;&#39;</span> <span class="sgr36">&#39;&#39;&#39;</span> <span class="sgr36">&#39;</span> <span class="sgr36">..</span> <span class="sgr36">..:&#39;&#39;&#39;&#39;&#39;</span>   <span class="sgr36">..:&#39;..</span>  <span class="sgr36">.:&#39;&#39;&#39;&#39;&#39;</span>  <span class="sgr36">&#39;</span> <span class="sgr36">..</span> <span class="sgr36">..:&#39;</span> <span class="sgr36">&#39;&#39;&#39;</span>   <span class="sgr36">..</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>         <span class="sgr36">.:&#39;.::&#39;</span>       <span class="sgr36">.::&#39;.:&#39;.::&#39;</span>       <span class="sgr36">.::&#39;.:&#39;&#39;</span>    <span class="sgr36">.</span>  <span class="sgr36">.:&#39;&#39;</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>      <span class="sgr36">.:&#39;</span> <span class="sgr36">.:&#39;..:</span>    <span class="sgr36">..:&#39;..:&#39;.:&#39;&#39;.:&#39;</span>    <span class="sgr36">.:&#39;..:&#39;..:</span>    <span class="sgr36">..:&#39;.::</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">.</span>  <span class="sgr36">..:&#39;.::&#39;.::&#39;</span>   <span class="sgr36">.::&#39;.::&#39;</span> <span class="sgr36">:&#39;.::&#39;</span>   <span class="sgr36">.::&#39;.::&#39;.:&#39;&#39;</span> <span class="sgr36">&#39;</span> <span class="sgr36">.::&#39;.:&#39;&#39;</span> <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">&#39;.::&#39;.::&#39;.:&#39;</span>    <span class="sgr36">.:::.:&#39;..</span>  <span class="sgr36">.:&#39;&#39;</span>   <span class="sgr36">.:::.:::.:&#39;</span>    <span class="sgr36">.:&#39;:::&#39;</span>    <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">:::::&#39;:::&#39;</span>      <span class="sgr36">&#39;.::&#39;.:&#39;&#39;</span>  <span class="sgr36">&#39;</span>      <span class="sgr36">&#39;:::&#39;.::&#39;</span>      <span class="sgr36">&#39;.::&#39;..</span>    <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">&#39;::&#39;</span> <span class="sgr36">::&#39;</span>   <span class="sgr36">..</span>  <span class="sgr36">.::&#39;::&#39;</span>    <span class="sgr36">..</span> <span class="sgr36">.</span>   <span class="sgr36">.::&#39;.::&#39;</span>   <span class="sgr36">..</span>  <span class="sgr36">.::&#39;::&#39;</span>    <span class="sgr36">.</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>         <span class="sgr36">.:&#39;.::&#39;</span>       <span class="sgr36">.::&#39;.:&#39;</span> <span class="sgr36">.:&#39;</span>       <span class="sgr36">..:&#39;.::&#39;</span>       <span class="sgr36">.::&#39;</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>      <span class="sgr36">.::&#39;.::&#39;.:</span>     <span class="sgr36">.:&#39;&#39;.:&#39;.::&#39;..</span>     <span class="sgr36">.::&#39;.:&#39;&#39;.:</span> <span class="sgr36">.</span>   <span class="sgr36">.:&#39;:.:</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>     <span class="sgr36">:&#39;&#39;</span> <span class="sgr36">:&#39;.::&#39;.:</span>  <span class="sgr36">::&#39;</span> <span class="sgr36">::&#39;.:&#39;:.:&#39;..</span>   <span class="sgr36">:&#39;</span> <span class="sgr36">::&#39;.::&#39;.:&#39;</span> <span class="sgr36">::&#39;.::&#39;.</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>     <span class="sgr36">.</span>   <span class="sgr36">.:&#39;..:&#39;</span>    <span class="sgr36">.:&#39;.::&#39;.:&#39;&#39;.:&#39;</span>    <span class="sgr36">.</span>  <span class="sgr36">..:&#39;.::&#39;</span>   <span class="sgr36">..:&#39;.::&#39;</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>  <span class="sgr36">..:&#39;.::&#39;.::&#39;</span>   <span class="sgr36">.::&#39;.::&#39;..&#39;.::&#39;</span>   <span class="sgr36">..:&#39;.::&#39;.:&#39;&#39;</span>   <span class="sgr36">.::&#39;.:&#39;&#39;</span>  <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">.::&#39;.:::.:&#39;</span>     <span class="sgr36">:::::&#39;.::&#39;</span> <span class="sgr36">:&#39;&#39;</span>    <span class="sgr36">:::.:::.:&#39;</span>     <span class="sgr36">:&#39;:::&#39;.::</span>  <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">::::&#39;:::&#39;</span>       <span class="sgr36">.::&#39;.::&#39;</span>   <span class="sgr36">.</span>      <span class="sgr36">.::&#39;.::&#39;</span>       <span class="sgr36">.::&#39;.:&#39;&#39;</span>   <span class="sgr90">|</span> 
    <span class="sgr90">|</span> <span class="sgr36">&#39;&#39;</span>  <span class="sgr36">&#39;&#39;</span>  <span class="sgr36">&#39;.:&#39;</span> <span class="sgr36">.:&#39;&#39;</span> <span class="sgr36">&#39;&#39;</span>    <span class="sgr36">.:&#39;..:</span> <span class="sgr36">.:&#39;&#39;</span> <span class="sgr36">&#39;&#39;&#39;</span>   <span class="sgr36">.:&#39;</span> <span class="sgr36">.:&#39;&#39;</span> <span class="sgr36">&#39;&#39;</span>    <span class="sgr36">.:</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>        <span class="sgr36">.:&#39;..:&#39;.</span>      <span class="sgr36">.::&#39;.:&#39;&#39;.:&#39;..</span>      <span class="sgr36">.:&#39;.::&#39;.</span>    <span class="sgr36">.</span> <span class="sgr36">.::&#39;.</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span>     <span class="sgr36">.::&#39;.::&#39;.:&#39;</span>    <span class="sgr36">.:&#39;&#39;.:&#39;.::&#39;.:&#39;</span>    <span class="sgr36">.::&#39;.:&#39;:.:&#39;.</span>   <span class="sgr36">.:&#39;..:&#39;</span><span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">.</span>  <span class="sgr36">.:&#39;:.:&#39;..:&#39;</span>  <span class="sgr36">&#39;.::&#39;.::&#39;</span>  <span class="sgr36">&#39;&#39;.:&#39;</span>   <span class="sgr36">..:&#39;:::&#39;..&#39;&#39;</span>  <span class="sgr36">&#39;.::&#39;.::&#39;</span>  <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">:::&#39;.::&#39;.:&#39;&#39;</span>    <span class="sgr36">:::.::&#39;..</span>  <span class="sgr36">::&#39;</span>    <span class="sgr36">::&#39;.::&#39;.:&#39;</span>     <span class="sgr36">:::.:&#39;&#39;</span>    <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">::::::::&#39;</span>       <span class="sgr36">.::&#39;.::&#39;</span>          <span class="sgr36">.::::::&#39;</span>       <span class="sgr36">.::&#39;.::</span>    <span class="sgr90">|</span> 
    <span class="sgr90">|</span><span class="sgr36">::::::&#39;..</span>       <span class="sgr36">::.::&#39;</span>            <span class="sgr36">:::::&#39;.</span>        <span class="sgr36">::.:&#39;</span>      <span class="sgr90">|</span> 
    <span class="sgr90">+------------------------------------------------------------+</span> </code></pre><pre><code class="language-julia hljs">typeof(R)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">RecurrenceMatrix{RecurrenceThreshold{Float64}}</code></pre><pre><code class="language-julia hljs">summary(R)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;(2001, 2001) RecurrenceMatrix with 383575 recurrences of type RecurrenceThreshold.&quot;</code></pre><p>The above simple plotting functionality is possible through the package <a href="https://github.com/Evizero/UnicodePlots.jl"><code>UnicodePlots</code></a>. The following function creates the plot:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.recurrenceplot" href="#RecurrenceAnalysis.recurrenceplot"><code>RecurrenceAnalysis.recurrenceplot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">recurrenceplot([io,] R; minh = 25, maxh = 0.5, ascii, kwargs...) -&gt; u</code></pre><p>Create a text-based scatterplot representation of a recurrence matrix <code>R</code> to be displayed in <code>io</code> (by default <code>stdout</code>) using <code>UnicodePlots</code>. The matrix spans at minimum <code>minh</code> rows and at maximum <code>maxh*displaysize(io)[1]</code> (i.e. by default half the display). As we always try to plot in equal aspect ratio, if the width of the plot is even less, the minimum height is dictated by the width.</p><p>The keyword <code>ascii::Bool</code> can ensure that all elements of the plot are ASCII characters (<code>true</code>) or Unicode (<code>false</code>).</p><p>The rest of the <code>kwargs</code> are propagated into <code>UnicodePlots.scatterplot</code>.</p><p>Notice that the accuracy of this function drops drastically for matrices whose size is significantly bigger than the width and height of the display (assuming each index of the matrix is one character).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/plot.jl#L28-L46">source</a></section></article><p>Here is the same plot but using Unicode Braille characters</p><pre><code class="language-julia hljs">recurrenceplot(R; ascii = false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">    <span class="sgr97"><span class="sgr1">(2001, 2001) RecurrenceMatrix with 383575 recurrences of type RecurrenceThreshold.</span></span> 
    <span class="sgr90">┌────────────────────────────────────────────────────────────┐</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣠⠞⠃⢀⣴⠟⠁</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠟⠁⣠⡶⠋⢀⣤⠞⠁</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣤⠞⠁⣀⡴⠟</span>⠀⠀⠀⠀<span class="sgr36">⢀⣤</span>⠀⠀<span class="sgr36">⣀⡴⠛</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀<span class="sgr36">⢀⡀</span>⠀⠀<span class="sgr36">⣠⣴⠟⠁⣠⡶⠋⠁</span>⠀⠀⠀<span class="sgr36">⣠⡴⠋</span>⠀<span class="sgr36">⣠⡾⠋⢀⣠⠘⠉⣀⡴⠟⠁</span>⠀⠀⠀<span class="sgr36">⢀</span>⠀⠀⠀<span class="sgr36">⣠⡴⠟⠁⣠⡾⠋</span>⠀⠀⠀⠀<span class="sgr36">⣠⡶⠋⢀⣠⡾⠋</span>⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀<span class="sgr36">⣠⡶⠋⢁⣤⡾⠋⢀⣴⠾⠋</span>⠀<span class="sgr36">⡀</span>⠀⠀<span class="sgr36">⢠⡾⠋⢀⣴⠟⠋⣀⡴⠟⠁⢠⡾⠋</span>⠀⠀⠀⠀<span class="sgr36">⢠⡾⠋⢀⣴⡾⠋⢀⣴⠟⠁⢀⡀</span>⠀⠀<span class="sgr36">⣴⡾⠋⣀⣴⠟⠁⣠⡴⠋</span>⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⡿⠋⣠⣴⡿⠋⣠⣶⠟⠁</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⢈⣠⣾⠟⢁⣠⡾⠋</span>⠀⠀⠀⠀<span class="sgr36">⢀⡀</span>⠀⠀⠀⠀<span class="sgr36">⠈⣠⣶⠟⠋⣠⣾⠟⠁</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⢁⣤⡾⠟⢁⣠⡾⠋</span>⠀⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀<span class="sgr36">⠚⠛⠁</span>⠀<span class="sgr36">⠚⠛⠁</span>⠀<span class="sgr36">⠒</span>⠀<span class="sgr36">⣠⡄</span>⠀<span class="sgr36">⢀⣠⠞⠛⠁⠐⠛⠋</span>⠀⠀⠀<span class="sgr36">⢀⣠⠞⠋⢀⡄</span>⠀⠀<span class="sgr36">⣠⡼⠛⠁⠐⠛⠋</span>⠀⠀<span class="sgr36">⠒</span>⠀<span class="sgr36">⣠⠄</span>⠀<span class="sgr36">⢀⣤⠟⠋</span>⠀<span class="sgr36">⠐⠛⠉</span>⠀⠀⠀<span class="sgr36">⢀⣤</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⣤⠞⠉⢀⣴⠟⠁</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠟⠁⣠⡾⠋⢀⣴⠞⠉</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠞⠁⣀⡴⠛⠁</span>⠀⠀⠀⠀<span class="sgr36">⡀</span>⠀⠀<span class="sgr36">⣠⡴⠛⠁</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⣀⡴⠂</span>⠀<span class="sgr36">⣠⡾⠋⢀⣠⠞</span>⠀⠀⠀⠀<span class="sgr36">⢀⣠⡾⠋⢀⣤⠞⠁⣠⡴⠛⠁⣠⡶⠃</span>⠀⠀⠀⠀<span class="sgr36">⣠⡴⠋⢀⣠⡾⠋⢀⣤⠞</span>⠀⠀⠀⠀<span class="sgr36">⢀⣤⠾⠋⢀⣴⠞</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⡀</span>⠀⠀<span class="sgr36">⢀⣤⡾⠋⢀⣴⠟⠋⢀⡴⠟⠁</span>⠀⠀⠀<span class="sgr36">⣀⣴⠟⠁⣠⡴⠟⠁</span>⠀<span class="sgr36">⠸⠋⢀⣴⠞⠁</span>⠀⠀⠀<span class="sgr36">⢀⣴⠾⠋⣀⣴⠟⠁⣀⡴⠋⠁</span>⠀<span class="sgr36">⠒</span>⠀<span class="sgr36">⣠⣴⠟⠁⣠⡶⠋⠁</span>⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⠃⣠⣶⠟⠉⣠⣾⠟⠁⣠⡾⠋</span>⠀⠀⠀⠀<span class="sgr36">⣠⣾⠟⢁⣤⡾⠋⢀⡀</span>⠀⠀<span class="sgr36">⢠⡴⠋⠁</span>⠀⠀⠀<span class="sgr36">⢠⣶⠟⢁⣠⡾⠟⢁⣠⠾⠋</span>⠀⠀⠀⠀<span class="sgr36">⣤⡾⠋⢁⣴⡾⠋</span>⠀⠀⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⣿⠟⣁⣴⡿⠋⣁⣴⠟⠋</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⠉⣠⣶⠿⠋⣠⡴⠛⠁</span>⠀⠀<span class="sgr36">⠈</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⠈⣡⣴⡿⠋⣠⣴⠟⠁</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⠉⣠⣾⠟⠁⣠⡄</span>⠀⠀⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⠁⠾⠿⠋</span>⠀<span class="sgr36">⠾⠟⠁</span>⠀⠀⠀<span class="sgr36">⢀⡀</span>⠀⠀<span class="sgr36">⣠⡾⠟⠁⠰⠾⠋</span>⠀⠀⠀⠀<span class="sgr36">⣠⡄</span>⠀<span class="sgr36">⢀</span>⠀⠀⠀<span class="sgr36">⣀⡼⠿⠋⠠⠾⠟⠁</span>⠀⠀⠀<span class="sgr36">⣀⡀</span>⠀⠀<span class="sgr36">⣠⠿⠟⠁⠰⠞⠋</span>⠀⠀⠀⠀<span class="sgr36">⣠</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⣠⡾⠋⢀⣴⠞⠉</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠞⠁⢠⡴⠋</span>⠀<span class="sgr36">⣠⡾⠋</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣠⠞⠋⢀⣴⠟⠁</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠟⠁</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠞⠁⣠⡴⠟⠁⣠⠶</span>⠀⠀⠀⠀⠀<span class="sgr36">⣠⡴⠋⠁⣠⡾⠋⢀⣴⠟⠁⣀⡤</span>⠀⠀⠀⠀⠀<span class="sgr36">⣀⣴⠟⠁⣠⡶⠋⠁⣠⠖</span>⠀<span class="sgr36">⢀</span>⠀⠀⠀<span class="sgr36">⣠⡾⠋⢁⣠⠞</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀<span class="sgr36">⠶⠋⠁</span>⠀<span class="sgr36">⠾⠋⢀⣴⠞⠁⣠⡴</span>⠀⠀<span class="sgr36">⠰⠾⠋</span>⠀<span class="sgr36">⠰⠟⠁⣠⡼⠛⢁⣤⠞⠋⢀⡄</span>⠀⠀⠀<span class="sgr36">⠾⠋</span>⠀<span class="sgr36">⠰⠾⠋⣀⡴⠟⠁⣠⠾⠋</span>⠀<span class="sgr36">⠰⠟⠋⢀⡰⠟⠁⣠</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀<span class="sgr36">⢀</span>⠀⠀⠀<span class="sgr36">⣠⡾⠋⢀⣤⠞⠋</span>⠀⠀⠀⠀<span class="sgr36">⣠⡶⠃⢀⣴⠞⠋⢠⡴⠛⠁⣠⡾⠋</span>⠀⠀⠀⠀<span class="sgr36">⣀</span>⠀⠀<span class="sgr36">⢀⣠⡾⠋⢀⣴⠞⠁</span>⠀⠀⠀<span class="sgr36">⢀⣠⠞⠋⢀⣴⠞⠁</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀<span class="sgr36">⢀⣠⡾⠋⢀⣴⠟⠋⢀⣴⠟⠁</span>⠀⠀⠀<span class="sgr36">⣀⣴⠟⠁⣠⣴⠟⠁⣠⠄⠈⢀⣴⠞⠉</span>⠀⠀⠀<span class="sgr36">⢀⣤⠞⠉⣀⣴⠟⠁⣠⡴⠛⠁</span>⠀⠀⠀<span class="sgr36">⣀⣴⠟⠁⣠⡶⠛⠁</span>⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⣠⣴⠟⠁⣠⣾⠟⢁⣠⡾⠋</span>⠀⠀⠀⠀⠀<span class="sgr36">⠸⠟⢁⣴⡾⠋⢀⣴⠞⠁</span>⠀<span class="sgr36">⠰⠛⠁</span>⠀⠀⠀⠀<span class="sgr36">⠰⠟⢁⣠⡾⠟⢁⣤⡾⠋</span>⠀⠀⠀⠀⠀<span class="sgr36">⠾⠋⢁⣴⡾⠋⢀⣴⠆</span>⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⠟⣁⣴⡿⠛⣁⣴⠿⠋</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢠⣶⡿⠋⣠⣶⠟⠁</span>⠀⠀⠀<span class="sgr36">⢀</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⢠⣴⡿⠋⣠⣴⠟⠉</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⣠⣶⠟⠉⣠⡾⠋⠁</span>⠀⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀<span class="sgr36">⠉⠉</span>⠀⠀<span class="sgr36">⠉⠁</span>⠀⠀<span class="sgr36">⠁⢀⡴⠂</span>⠀<span class="sgr36">⣠⡶⠋⠁</span>⠀<span class="sgr36">⠈⠉</span>⠀⠀⠀⠀<span class="sgr36">⣠⡶⠋⢀⣤⠆</span>⠀<span class="sgr36">⣀⡴⠋⠉</span>⠀<span class="sgr36">⠈⠉⠁</span>⠀⠀⠀<span class="sgr36">⣀⡴⠂</span>⠀<span class="sgr36">⣠⡶⠋⠁</span>⠀<span class="sgr36">⠈⠉</span>⠀⠀⠀⠀<span class="sgr36">⣠⠶</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⣠⠾⠋⢀⣤⠞⠋⢀</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠞⠉⣀⡰⠋⠁⣠⡾⠋⢀⡀</span>⠀⠀⠀⠀⠀⠀<span class="sgr36">⣠⠾⠋⢀⣴⠟⠁⢀</span>⠀⠀⠀⠀<span class="sgr36">⠄</span>⠀<span class="sgr36">⢀⣴⠟⠁⣀</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span>⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⠞⠁⣠⡴⠟⠁⣠⡶⠋</span>⠀⠀⠀⠀<span class="sgr36">⣠⡶⠛⠁⣠⡾⠋⢀⣴⠟⠁⣀⡴⠋</span>⠀⠀⠀⠀<span class="sgr36">⣀⣴⠟⠁⣠⡶⠋⢁⣠⠾⠋⢀</span>⠀⠀⠀<span class="sgr36">⣠⡾⠋⢀⣠⠾⠋</span><span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⡤</span>⠀⠀<span class="sgr36">⣠⡾⠛⢁⣤⡾⠋⢀⣤⠞⠁</span>⠀⠀<span class="sgr36">⠈⢀⣴⡾⠋⢀⣴⠟⠉</span>⠀⠀<span class="sgr36">⠈⠁⣠⠾⠋</span>⠀⠀⠀<span class="sgr36">⢀⣠⡾⠋⢁⣴⡾⠋⢀⡤⠈⠁</span>⠀⠀<span class="sgr36">⠉⢀⣴⠿⠋⣀⣴⠟⠁</span>⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⣁⣴⡿⠋⣠⣴⠟⠋⣠⡴⠛⠁</span>⠀⠀⠀⠀<span class="sgr36">⣼⠟⢉⣠⡾⠟⠁⣠⠄</span>⠀⠀<span class="sgr36">⢰⠟⠁</span>⠀⠀⠀⠀<span class="sgr36">⢰⡿⠋⣠⣶⠟⠁⣠⡶⠋</span>⠀⠀⠀⠀⠀<span class="sgr36">⣾⠟⢁⣠⡾⠋⠁</span>⠀⠀⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⡿⢋⣴⣾⠟⢁⣴⡾⠋</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢠⣴⡿⠋⣀⣴⠟⠁</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⢀⣴⣿⠟⣁⣴⡿⠋</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⣠⣴⡿⠋⣀⣴⠆</span>⠀⠀⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">│</span><span class="sgr36">⣾⣿⢟⣡⣾⡿⠋⣀⡀</span>⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⠻⢋⣤⣾⠟⠁</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⠸⢋⣥⣾⠟⠉⣀</span>⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr36">⠟⢋⣤⡾⠋</span>⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
    <span class="sgr90">└────────────────────────────────────────────────────────────┘</span> </code></pre><p>As you can see, the Unicode based plotting doesn&#39;t display nicely everywhere. It does display perfectly in e.g. VSCode, which is where it is the default printing type.</p><h2 id="Advanced-Recurrence-Plots"><a class="docs-heading-anchor" href="#Advanced-Recurrence-Plots">Advanced Recurrence Plots</a><a id="Advanced-Recurrence-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Recurrence-Plots" title="Permalink"></a></h2><p>A text-based plot is cool, fast and simple. But often one needs the full resolution offered by the data of a recurrence matrix.</p><p>There are two more ways to plot a recurrence matrix using <code>RecurrenceAnalysis</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.coordinates" href="#RecurrenceAnalysis.coordinates"><code>RecurrenceAnalysis.coordinates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coordinates(R) -&gt; xs, ys</code></pre><p>Return the coordinates of the recurrence points of <code>R</code> (in indices).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/plot.jl#L6-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.grayscale" href="#RecurrenceAnalysis.grayscale"><code>RecurrenceAnalysis.grayscale</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">grayscale(R [, bwcode]; width::Int, height::Int, exactsize=false)</code></pre><p>Transform the recurrence matrix <code>R</code> into a full matrix suitable for plotting as a grayscale image. By default it returns a matrix with the same size as <code>R</code>, but switched axes, containing &quot;black&quot; values in the cells that represent recurrent points, and &quot;white&quot; values in the empty cells and interpolating in-between for cases with both recurrent and empty cells, see below.</p><p>The numeric codes for black and white are given in a 2-element tuple as a second optional argument. Its default value is <code>(0.0, 1.0)</code>, i.e. black is coded as <code>0.0</code> (no brightness) and white as <code>1.0</code> (full brightness). The type of the elements in the tuple defines the type of the returned matrix. This must be taken into account if, for instance, the image is coded as a matrix of integers corresponding to a grayscale; in such case the black and white codes must be given as numbers of the required integer type.</p><p>The keyword arguments <code>width</code> and <code>height</code> can be given to define a custom size of the image. If only one dimension is given, the other is automatically calculated. If both dimensions are given, by default they are adjusted to keep an aspect proportional to the original matrix, such that the returned matrix fits into a matrix of the given dimensions. This automatic adjustment can be disabled by passing the keyword argument <code>exactsize=true</code>.</p><p>If the image has different dimensions than <code>R</code>, the cells of <code>R</code> are distributed in a grid with the size of the image, and a gray level between white and black is calculated for each element of the grid, proportional to the number of recurrent points contained in it. The levels of gray are coded as numbers of the same type as the black and white codes.</p><p>It is advised to use <code>width, height</code> arguments for large matrices otherwise plots using functions like e.g. <code>heatmap</code> could be misleading.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/plot.jl#L127-L159">source</a></section></article><p>For example, here is the representation of the above <code>R</code> from the Roessler system using both plotting approaches:</p><pre><code class="language-julia hljs">using CairoMakie
fig = Figure(resolution = (1000,500))

ax = Axis(fig[1,1])
xs, ys = coordinates(R)
scatter!(ax, xs, ys; color = :black, markersize = 1)
ax.limits = ((1, size(R, 1)), (1, size(R, 2)));
ax.aspect = 1

ax2 = Axis(fig[1,2]; aspect = 1)
Rg = grayscale(R)
heatmap!(ax2, Rg; colormap = :grays)
fig</code></pre><img src="fbcfc22f.png" alt="Example block output"/><p>and here is exactly the same process, but using a delay embedded trajectory instead</p><pre><code class="language-julia hljs">using DelayEmbeddings

y = X[:, 2]
τ = estimate_delay(y, &quot;mi_min&quot;)
m = embed(y, 3, τ)
E = RecurrenceMatrix(m, 5.0; metric = &quot;euclidean&quot;)

xs, ys = coordinates(E)
fig, ax = scatter(xs, ys; markersize = 1)
ax.aspect = 1
fig</code></pre><img src="7422a09d.png" alt="Example block output"/><p>which justifies why recurrence plots are so fitting to be used in embedded timeseries.</p><div class="admonition is-warning"><header class="admonition-header">Careful when using Recurrence Plots</header><div class="admonition-body"><p>It is easy when using <code>grayscale</code> to not change the width/height parameters. The width and height are important when in <code>grayscale</code> when the matrix size exceeds the display size! Most plotting libraries may resample arbitrarily or simply limit the displayed pixels, so one needs to be extra careful.</p><p>Besides graphical problems there are also other potential pitfalls dealing with the conceptual understanding and use of recurrence plots. All of these are summarized in the following paper which we suggest users to take a look at:</p><p>N. Marwan, <em>How to avoid potential pitfalls in recurrence plot based data analysis</em>, Int. J. of Bifurcations and Chaos (<a href="http://arxiv.org/abs/1007.2215">arXiv</a>).</p></div></div><h2 id="Skeletonized-Recurrence-Plots"><a class="docs-heading-anchor" href="#Skeletonized-Recurrence-Plots">Skeletonized Recurrence Plots</a><a id="Skeletonized-Recurrence-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Skeletonized-Recurrence-Plots" title="Permalink"></a></h2><p>The finite size of a recurrence plot can cause border effects in the recurrence quantification-measures <a href="../quantification/#RecurrenceAnalysis.rqa"><code>rqa</code></a>. Also the sampling rate of the data and the chosen recurrence threshold selection method (<code>fixed</code>, <code>fixedrate</code>, <code>FAN</code>) plays a crucial role. They can cause the thickening of diagonal lines in the recurrence matrix. Both problems lead to biased line-based RQA-quantifiers and is discussed in:</p><p>K.H. Kraemer &amp; N. Marwan, <em>Border effect corrections for diagonal line based recurrence quantification analysis measures</em>, <a href="https://publications.pik-potsdam.de/rest/items/item_23376_6/component/file_24222/content">Phys. Lett. A 2019</a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.skeletonize" href="#RecurrenceAnalysis.skeletonize"><code>RecurrenceAnalysis.skeletonize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">skeletonize(R) → R_skel</code></pre><p>Skeletonize the <code>RecurrenceMatrix R</code> by using the algorithm proposed by Kraemer &amp; Marwan <sup class="footnote-reference"><a id="citeref-Kraemer2019" href="#footnote-Kraemer2019">[Kraemer2019]</a></sup>. This function returns <code>R_skel</code>, a recurrence matrix, which only consists of diagonal lines of &quot;thickness&quot; one.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/skeletonization.jl#L8-L16">source</a></section></article><p>Consider, e.g. a skeletonized version of a simple sinusoidal:</p><pre><code class="language-julia hljs">using RecurrenceAnalysis, DelayEmbeddings, CairoMakie

data = sin.(2*π .* (0:400)./ 60)
Y = embed(data, 3, 15)

R = RecurrenceMatrix(Y, GlobalRecurrenceRate(0.25))
R_skel = skeletonize(R)

fig = Figure(resolution = (1000,600))
ax = Axis(fig[1,1]; title = &quot;RP of monochromatic signal&quot;)
heatmap!(ax, grayscale(R); colormap = :grays)

ax = Axis(fig[1,2]; title = &quot;skeletonized RP&quot;)
heatmap!(ax, grayscale(R_skel); colormap = :grays)
fig</code></pre><img src="62c016fd.png" alt="Example block output"/><p>This way spurious diagonal lines get removed from the recurrence matrix, which would otherwise effect the quantification based on these lines.</p><h2 id="Distance-matrix"><a class="docs-heading-anchor" href="#Distance-matrix">Distance matrix</a><a id="Distance-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Distance-matrix" title="Permalink"></a></h2><p>The distance function used in <a href="#RecurrenceAnalysis.RecurrenceMatrix"><code>RecurrenceMatrix</code></a> and co. can be specified either as any <code>Metric</code> instance from <a href="https://github.com/JuliaStats/Distances.jl"><code>Distances</code></a>. In addition, the following function returns a matrix with the cross-distances across all points in one or two trajectories:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RecurrenceAnalysis.distancematrix" href="#RecurrenceAnalysis.distancematrix"><code>RecurrenceAnalysis.distancematrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">distancematrix(x [, y = x], metric = &quot;euclidean&quot;)</code></pre><p>Create a matrix with the distances between each pair of points of the time series <code>x</code> and <code>y</code> using <code>metric</code>.</p><p>The time series <code>x</code> and <code>y</code> can be <code>AbstractDataset</code>s or vectors or matrices with data points in rows. The data point dimensions (or number of columns) must be the same for <code>x</code> and <code>y</code>. The returned value is a <code>n×m</code> matrix, with <code>n</code> being the length (or number of rows) of <code>x</code>, and <code>m</code> the length of <code>y</code>.</p><p>The metric can be any of the <code>Metric</code>s defined in the <a href="https://github.com/JuliaStats/Distances.jl"><code>Distances</code> package</a> and defaults to <code>Euclidean()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/RecurrenceAnalysis.jl/blob/64229ed2b15e99cebbe079e7da115ef7af17df5c/src/matrices/distance_matrix.jl#L4-L19">source</a></section></article><h2 id="StateSpaceSet-reference"><a class="docs-heading-anchor" href="#StateSpaceSet-reference"><code>StateSpaceSet</code> reference</a><a id="StateSpaceSet-reference-1"></a><a class="docs-heading-anchor-permalink" href="#StateSpaceSet-reference" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceSets.StateSpaceSet" href="#StateSpaceSets.StateSpaceSet"><code>StateSpaceSets.StateSpaceSet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">StateSpaceSet{D, T} &lt;: AbstractStateSpaceSet{D,T}</code></pre><p>A dedicated interface for sets in a state space. It is an <strong>ordered container of equally-sized points</strong> of length <code>D</code>. Each point is represented by <code>SVector{D, T}</code>. The data are a standard Julia <code>Vector{SVector}</code>, and can be obtained with <code>vec(ssset::StateSpaceSet)</code>. Typically the order of points in the set is the time direction, but it doesn&#39;t have to be.</p><p>When indexed with 1 index, <code>StateSpaceSet</code> is like a vector of points. When indexed with 2 indices it behaves like a matrix that has each of the columns be the timeseries of each of the variables. When iterated over, it iterates over its contained points. See description of indexing below for more.</p><p><code>StateSpaceSet</code> also supports almost all sensible vector operations like <code>append!, push!, hcat, eachrow</code>, among others.</p><p><strong>Description of indexing</strong></p><p>In the following let <code>i, j</code> be integers, <code>typeof(X) &lt;: AbstractStateSpaceSet</code> and <code>v1, v2</code> be <code>&lt;: AbstractVector{Int}</code> (<code>v1, v2</code> could also be ranges, and for performance benefits make <code>v2</code> an <code>SVector{Int}</code>).</p><ul><li><code>X[i] == X[i, :]</code> gives the <code>i</code>th point (returns an <code>SVector</code>)</li><li><code>X[v1] == X[v1, :]</code>, returns a <code>StateSpaceSet</code> with the points in those indices.</li><li><code>X[:, j]</code> gives the <code>j</code>th variable timeseries (or collection), as <code>Vector</code></li><li><code>X[v1, v2], X[:, v2]</code> returns a <code>StateSpaceSet</code> with the appropriate entries (first indices being &quot;time&quot;/point index, while second being variables)</li><li><code>X[i, j]</code> value of the <code>j</code>th variable, at the <code>i</code>th timepoint</li></ul><p>Use <code>Matrix(ssset)</code> or <code>StateSpaceSet(matrix)</code> to convert. It is assumed that each <em>column</em> of the <code>matrix</code> is one variable. If you have various timeseries vectors <code>x, y, z, ...</code> pass them like <code>StateSpaceSet(x, y, z, ...)</code>. You can use <code>columns(dataset)</code> to obtain the reverse, i.e. all columns of the dataset in a tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/StateSpaceSets.jl/blob/v1.4.6/src/statespaceset_concrete.jl#L3-L41">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Marwan2007"><a class="tag is-link" href="#citeref-Marwan2007">Marwan2007</a>N. Marwan <em>et al.</em>, &quot;Recurrence plots for the analysis of complex systems&quot;, <a href="https://doi.org/10.1016/j.physrep.2006.11.001">Phys. Reports 438*(5-6), 237-329 (2007)</a></li><li class="footnote" id="footnote-Marwan2015"><a class="tag is-link" href="#citeref-Marwan2015">Marwan2015</a>N. Marwan &amp; C.L. Webber, <em>Recurrence Quantification Analysis. Theory and Best Practices</em> <a href="https://link.springer.com/book/10.1007/978-3-319-07155-8">Springer (2015)</a></li><li class="footnote" id="footnote-Kraemer2019"><a class="tag is-link" href="#citeref-Kraemer2019">Kraemer2019</a>Kraemer, K.H., Marwan, N. (2019). <a href="https://doi.org/10.1016/j.physleta.2019.125977">Border effect corrections for diagonal line based recurrence quantification analysis measures. Physics Letters A 383(34)</a>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« RecurrenceAnalysis.jl</a><a class="docs-footer-nextpage" href="../quantification/">Recurrence Quantification Analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Sunday 9 June 2024 18:55">Sunday 9 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
